[build-system]
build-backend = 'mesonpy'
requires = [
  'meson-python',
  'meson>=1.2.3',
	'numpy~=1.21.0; python_version<"3.11"',
	'oldest-supported-numpy; python_version>="3.11"'
]

[tool.meson-python.args]
#setup = ['-Dc_link_args=-lquadmath']
compile = ['-j4']
#install = []
#dist = []

[project]
name = 'pysces'
dependencies = [
	'numpy',
	'matplotlib',
	'scipy'
]
dynamic = ['version']
description = 'The Python Simulator for Cellular Systems - simulation and analysis tools for modelling biological systems'
readme = 'DESCRIPTION.md'
requires-python = '>=3.8'
license = {text = 'BSD 3-Clause'}
authors = [
  {name = 'Brett Olivier', email = 'pysces@googlegroups.com'},
  {name = 'Johann Rohwer', email = 'pysces@googlegroups.com'},
]
maintainers = [
  {name = 'Brett Olivier', email = 'pysces@googlegroups.com'},
  {name = 'Johann Rohwer', email = 'pysces@googlegroups.com'},
]
keywords = [
	'computational systems biology',
	'modelling',
	'simulation',
	'systems biology',
]
classifiers=[
	'Development Status :: 5 - Production/Stable',
	'Development Status :: 6 - Mature',
	'Environment :: Console',
	'Intended Audience :: End Users/Desktop',
	'Intended Audience :: Science/Research',
	'License :: OSI Approved :: BSD License',
	'Natural Language :: English',
	'Operating System :: OS Independent',
	'Programming Language :: Fortran',
	'Programming Language :: Python',
	'Topic :: Scientific/Engineering :: Bio-Informatics',
	'Topic :: Scientific/Engineering :: Chemistry',
]

[project.optional-dependencies]
parscan = ['ipyparallel']
cvode = ['assimulo']
sbml = ['python_libsbml']
all = [
	'ipyparallel',
	'assimulo',
	'python_libsbml'
]

[project.urls]
homepage = "https://pysces.github.io"
documentation = "https://pyscesdocs.readthedocs.io"
source = "https://github.com/PySCeS/pysces"
download = "https://github.com/PySCeS/pysces/releases"
tracker = "https://github.com/PySCeS/pysces/issues"

[tool.cibuildwheel]
build = "cp312-* cp311-* cp310-* cp39-* cp38-*"
skip = "*musllinux* pp*"
build-verbosity = "3"
test-command = "python -s -c \"import pysces; pysces.test(3)\""
build-frontend="pip"

[tool.cibuildwheel.linux]
archs = "x86_64"
manylinux-x86_64-image = "manylinux2014"

[tool.cibuildwheel.macos]
archs = "x86_64"
before-build = [
	"sudo ln -sf /usr/local/bin/gfortran-11 /usr/local/bin/gfortran",
	"sudo mkdir -p /usr/local/gfortran",
	"sudo ln -sf /usr/local/Cellar/gcc@11/*/lib/gcc/11 /usr/local/gfortran/lib",
	"gfortran --version",
]

[tool.cibuildwheel.windows]
archs = "AMD64"

[[tool.cibuildwheel.overrides]]
select = "cp312-*win*"
before-build = [
	"python -m pip install scikit-build meson cmake ninja",
	"python -m pip install -i https://pypi.anaconda.org/scientific-python-nightly-wheels/simple numpy==2.0.0.dev0",
]
build-frontend = "pip; args: --no-build-isolation"

[tool.cibuildwheel.overrides.environment]
CMAKE_GENERATOR = "MSYS Makefiles"
PATH = "c:\\\\rtools40\\\\ucrt64\\\\bin;c:\\\\rtools40\\\\usr\\\\bin;$PATH"