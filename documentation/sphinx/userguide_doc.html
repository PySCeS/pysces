

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; PySCeS User Guide v0.9</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PySCeS User Guide v0.9" href="index.html" />
    <link rel="next" title="The PySCeS Model Description Language" href="inputfile_doc.html" />
    <link rel="prev" title="PySCeS User Guide" href="userguide.html" /> 
  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<img src="_static/pysces_header.gif" alt="Sphinx logo" />
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inputfile_doc.html" title="The PySCeS Model Description Language"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="userguide.html" title="PySCeS User Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="userguide.html">PySCeS User Guide v0.9</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="userguide.html">
              <img class="logo" src="_static/pysces_logo_2.gif" alt="Logo"/>
            </a></p>
  <h3><a href="userguide.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li><a class="reference internal" href="#loading-pysces">Loading PySCeS</a></li>
<li><a class="reference internal" href="#creating-a-pysces-model-object">Creating a PySCeS model object</a><ul>
<li><a class="reference internal" href="#advanced">Advanced</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Creating a PySCeS model object</a></li>
<li><a class="reference internal" href="#basic-model-attributes">Basic model attributes</a><ul>
<li><a class="reference internal" href="#id2">Advanced</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#modelling">Modelling</a><ul>
<li><a class="reference internal" href="#structural-analysis">Structural Analysis</a><ul>
<li><a class="reference internal" href="#structural-analysis-new-objects">Structural Analysis - new objects</a></li>
<li><a class="reference internal" href="#structural-analysis-legacy">Structural Analysis - legacy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#time-simulation">Time simulation</a><ul>
<li><a class="reference internal" href="#simulation-results">Simulation results</a></li>
<li><a class="reference internal" href="#id4">Advanced</a></li>
</ul>
</li>
<li><a class="reference internal" href="#steady-state-analysis">Steady-state analysis</a><ul>
<li><a class="reference internal" href="#new-mod-data-sstate">New: mod.data_sstate</a></li>
<li><a class="reference internal" href="#stability">Stability</a></li>
</ul>
</li>
<li><a class="reference internal" href="#metabolic-control-analysis">Metabolic Control Analysis</a><ul>
<li><a class="reference internal" href="#elasticities">Elasticities</a></li>
<li><a class="reference internal" href="#control-coefficients">Control coefficients</a></li>
<li><a class="reference internal" href="#response-coefficients">Response coefficients</a></li>
<li><a class="reference internal" href="#responce-coefficients-with-respect-to-moiety-conserved-sums">Responce coefficients with respect to moiety-conserved sums</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameter-scanning">Parameter scanning</a><ul>
<li><a class="reference internal" href="#single-dimension-parameter-scans">Single dimension parameter scans</a></li>
<li><a class="reference internal" href="#two-dimension-parameter-scans">Two dimension parameter scans</a></li>
<li><a class="reference internal" href="#multi-dimension-parameter-scans">Multi-dimension parameter scans</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting">Plotting</a></li>
<li><a class="reference internal" href="#displaying-data">Displaying data</a><ul>
<li><a class="reference internal" href="#displaying-saving-model-attributes">Displaying/saving model attributes</a></li>
<li><a class="reference internal" href="#writing-formatted-arrays">Writing formatted arrays</a><ul>
<li><a class="reference internal" href="#write-array"><tt class="docutils literal"><span class="pre">Write_array()</span></tt></a></li>
<li><a class="reference internal" href="#write-array-latex"><tt class="docutils literal"><span class="pre">Write_array_latex()</span></tt></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#installing-and-configuring">Installing and configuring</a><ul>
<li><a class="reference internal" href="#configuring">Configuring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="userguide.html"
                        title="previous chapter">PySCeS User Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="inputfile_doc.html"
                        title="next chapter">The PySCeS Model Description Language</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/userguide_doc.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<span id="introducing-pysces"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>PySCeS: the Python Simulator for Cellular Systems is an extendable toolkit for
the analysis and investigation of cellular systems. It is available for
download at <a class="reference external" href="http://pysces.sourceforge.net">http://pysces.sourceforge.net</a></div></blockquote>
<p>Welcome! This users guide will get you started with the basics of modelling
cellular systems with PySCeS. It is meant to be used together with the <em>input
file guide</em>. If you already have PySCeS installed continue straight on
if not, <a class="reference internal" href="#installing-pysces"><em>Installing and configuring</em></a> contains instructions on building and
installing PySCeS.</p>
<blockquote>
<div>PySCeS is distributed under the PySCeS (BSD style) license and is made
freely available as Open Source software. See LICENCE.txt for details.</div></blockquote>
<p>PySCeS continued development depends, to a large degree on
support and feedback from Systems Biology community,
if you use PySCeS in your work please cite it using the
following reference:</p>
<blockquote>
<div>Brett G. Olivier, Johann M. Rohwer and Jan-Hendrik S. Hofmeyr
<em>Modelling cellular systems with PySCeS</em>, Bioinformatics, 21, 560-561,
DOI 10.1093/bioinformatics/bti046.</div></blockquote>
<p>We hope that you will enjoy using our software. If, however, you find any
unexpected features (i.e. bugs) or have any suggestions on how we can improve
PySCeS please let us know.</p>
<p><strong>The PySCeS development team.</strong></p>
</div>
<div class="section" id="getting-started">
<span id="running-pysces"></span><h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="loading-pysces">
<h2>Loading PySCeS<a class="headerlink" href="#loading-pysces" title="Permalink to this headline">¶</a></h2>
<p>In this section we assume you have PySCeS installed and
configured (see <a class="reference internal" href="#installing-and-configuring">Installing and configuring</a> for details) and a
correctly formatted PySCeS input file that describes a cellular
system in terms of its reactions, species and parameters. For a
detailed description of the PySCeS Model Description Language
see the <em>PySCeS Input File Guide</em>. Note that on all platforms
PySCeS model files have the extension <tt class="docutils literal"><span class="pre">.psc</span></tt>.</p>
<p>To begin modelling we need to start up an interactive Python shell
(we suggest <a class="reference external" href="http://ipython.scipy.org">iPython</a>) and load PySCeS with <tt class="docutils literal"><span class="pre">import</span> <span class="pre">pysces</span></tt>:</p>
<div class="highlight-python"><pre>Python 2.5.2 (r252:60911, Feb 21 2008, 13:11:45) [MSC v.1310 32 bit (Intel)]
Type "copyright", "credits" or "license" for more information.

&gt;&gt;&gt; import pysces

Matplotlib interface loaded (pysces.plt.m)
GnuPlot interface loaded (pysces.plt.g)
Continuation routines available
NLEQ2 routines available
You are using NumPy (1.4.0) with SciPy (0.8)
PySundials available

PySCeS environment
******************
pysces.model_dir = C:\mypysces\pscmodels
pysces.output_dir = C:\mypysces</pre>
</div>
<ul class="simple">
<li>Copyright(C) B.G. Olivier, J.M. Rohwer, J.-H.S. Hofmeyr, 2004-2012  *</li>
<li>Triple-J Group for Molecular Cell Physiology                        *</li>
<li>Stellenbosch University, South Africa                               *</li>
<li>PySCeS is distributed under the PySCeS (BSD style) licence, see     *</li>
<li>LICENCE.txt (supplied with this release) for details                *</li>
</ul>
<hr class="docutils" />
<p>PySCeS is now ready to use. If you would like to test your
installation try running the test suite:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pysces</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
</pre></div>
</div>
<p>this also copies the test models supplied with PySCeS into your
model directory.</p>
</div>
<div class="section" id="creating-a-pysces-model-object">
<h2>Creating a PySCeS model object<a class="headerlink" href="#creating-a-pysces-model-object" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>This guide uses the test models supplied with PySCeS as
examples, if you would like to use them and have not already
done so run the PySCeS tests (described in the previous
section).</div></blockquote>
<p>Before modelling, a PySCeS model object needs to be instantiated.
As a convention we use <tt class="docutils literal"><span class="pre">mod</span></tt> as the instantiated model
instance. The following code creates such an instance using the
test input file, <tt class="docutils literal"><span class="pre">pysces_test_linear1.psc</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">pysces</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s">&#39;pysces_test_linear1&#39;</span><span class="p">)</span>

<span class="go">Assuming extension is .psc</span>
<span class="go">Using model directory: C:\mypysces\pscmodels</span>
<span class="go">C:\mypysces\pscmodels\pysces_test_linear1.psc loading .....</span>

<span class="go">Parsing file: C:\mypysces\pscmodels\pysces_test_linear1.psc</span>
<span class="go">Calculating L matrix . . . . . . .  done.</span>
<span class="go">Calculating K matrix . . . . . . .  done.</span>
</pre></div>
</div>
<p>When instantiating a new model object, PySCeS input files are
assumed to have a <tt class="docutils literal"><span class="pre">.psc</span></tt> extension. If the specified input
file does not exist in the input file directory (e.g.
misspelled filename) a list of existing input files is shown
and the user is given an opportunity to enter the correct
filename.</p>
<div class="section" id="advanced">
<h3>Advanced<a class="headerlink" href="#advanced" title="Permalink to this headline">¶</a></h3>
<p>The model constructor can also be used to specify a model
directory other than the default model path:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span> <span class="o">=</span> <span class="n">pysces</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s">&#39;pysces_test_linear1&#39;</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s">&#39;c:</span><span class="se">\\</span><span class="s">Pysces</span><span class="se">\\</span><span class="s">psc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>alternatively input files can also be loaded from a string:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="s">&#39;c:</span><span class="se">\\</span><span class="s">Pysces</span><span class="se">\\</span><span class="s">psc</span><span class="se">\\</span><span class="s">pysces_test_linear1.psc&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pscS</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">pysces</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="s">&#39;test_lin1s&#39;</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="s">&#39;string&#39;</span><span class="p">,</span> <span class="n">fString</span><span class="o">=</span><span class="n">pscS</span><span class="p">)</span>

<span class="go">Assuming extension is .psc</span>
<span class="go">Using model directory: C:\mypysces\pscmodels</span>
<span class="go">Using file: test_lin1s.psc</span>
<span class="go">C:\mypysces\pscmodels\orca\test_lin1s.psc loading .....</span>
</pre></div>
</div>
<p>note that now the input file is saved and loaded as
<tt class="docutils literal"><span class="pre">model_dir\orca\test_lin1s.psc</span></tt>.</p>
</div>
</div>
<div class="section" id="id1">
<h2>Creating a PySCeS model object<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Once a new model object has been created it needs to be loaded.
During the load process the input file is parsed, the model
description is translated into Python data structures and a
stoichiometric structural analysis is performed:</p>
<div class="highlight-python"><pre>**New** in PySCeS 0.7.1+ model loading is now automatically performed
when the model object is instantiated. This behaviour is controlled
by the *autoload* argument (default = True). To keep backwards compatibility
with older modelling scripts the first time ``doLoad()`` is called a warning
is generated. Subsequent calls to ``doLoad()`` will reload the model as required.</pre>
</div>
<p>Once loaded, all the model elements contained in the input file
are made available as model (<tt class="docutils literal"><span class="pre">mod</span></tt>) attributes so that in the
input file where you might find initialisations such as <tt class="docutils literal"><span class="pre">s1</span> <span class="pre">=</span>
<span class="pre">1.0</span></tt> and <tt class="docutils literal"><span class="pre">k1</span> <span class="pre">=</span> <span class="pre">10.0</span></tt> these are now available as <tt class="docutils literal"><span class="pre">mod.s1</span></tt>
and <tt class="docutils literal"><span class="pre">mod.k1</span></tt>. For variable species and compartments an
additional attribute is created which contains the elements
<em>initial</em> (as opposed to current) value. These are constructed as
&lt;name&gt;*_init*:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">s1</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">s1_init</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">k1</span>
<span class="go">10.0</span>
</pre></div>
</div>
<p>Any errors generated during the loading process (almost always)
occur as a result of syntax errors in the input file. These
error messages may not be intuitive for example, &#8216;list out of
range&#8217; exception usually indicates a missing multiplication
operator &#8220;3(&#8221; instead of &#8220;3*(&#8221; or unbalanced parentheses.</p>
</div>
<div class="section" id="basic-model-attributes">
<h2>Basic model attributes<a class="headerlink" href="#basic-model-attributes" title="Permalink to this headline">¶</a></h2>
<p>Some basic model properties are accessible once the model is
loaded:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.ModelFile</span></tt>, the name of the model file that was used.</li>
<li><tt class="docutils literal"><span class="pre">mod.ModelDir</span></tt>, the input file directory.</li>
<li><tt class="docutils literal"><span class="pre">mod.ModelOutput</span></tt>, the PySCeS work/output directory.</li>
<li>Parameters are available as attributes directly as specified
in the input file e.g. <tt class="docutils literal"><span class="pre">k1</span></tt> is <tt class="docutils literal"><span class="pre">mod.k1</span></tt>.</li>
<li>External (fixed) species are made available in the same way.</li>
<li>Internal (variable) species are treated in a similar way except that an
additional attribute (parameter) is created to hold the species initial value
(as specified in the input file), e.g., from <tt class="docutils literal"><span class="pre">s1</span></tt>, <tt class="docutils literal"><span class="pre">mod.s1</span></tt> and
<tt class="docutils literal"><span class="pre">mod.s1_init</span></tt> are instantiated as model object attributes.</li>
<li>Compartments are also are assigned an initial value.</li>
<li>Rate equations are translated into objects that return their current value
when called <tt class="docutils literal"><span class="pre">mod.R1()</span></tt>.</li>
</ul>
<p>All basic model attributes that are described here can be
changed interactively. However, if the model rate equations need
to be changed, this should be done in the input file after
which the model should be re-instantiated and reloaded.</p>
<p>Groups of model properties (either tuples, lists or dictionaries)</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.species</span></tt> the model&#8217;s variable species names (ordered
relative to the stoichiometric matrix rows).</li>
<li><tt class="docutils literal"><span class="pre">mod.reactions</span></tt> reaction names and ordered to the stoichiometric matrices columns.</li>
<li><tt class="docutils literal"><span class="pre">mod.parameters</span></tt> all parameters (including fixed species)</li>
<li><tt class="docutils literal"><span class="pre">mod.fixed_species</span></tt> only the fixed species names</li>
<li><tt class="docutils literal"><span class="pre">mod.__rate_rules__</span></tt> a list of rate rules defined in the model</li>
</ul>
<div class="section" id="id2">
<h3>Advanced<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>These attributes are used by PySCeS to store additional
information about the basic model components, generally they
are supplied by the parser and should almost never be changed
directly.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.__events__</span></tt> a list of event object references
which can be interrogated for event information. For example if you
want a list of event names try <tt class="docutils literal"><span class="pre">[ev.name</span> <span class="pre">for</span> <span class="pre">ev</span> <span class="pre">in</span> <span class="pre">mod.__events__]</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.__rules__</span></tt> a dictionary containing information about all rules defined for this model</li>
<li><tt class="docutils literal"><span class="pre">mod.__sDict__</span></tt> a dictionary of species information</li>
<li><tt class="docutils literal"><span class="pre">mod.__compartments__</span></tt> a dictionary containing compartment information</li>
</ul>
</div>
</div>
</div>
<div class="section" id="modelling">
<span id="core-analysis"></span><h1>Modelling<a class="headerlink" href="#modelling" title="Permalink to this headline">¶</a></h1>
<div class="section" id="structural-analysis">
<h2>Structural Analysis<a class="headerlink" href="#structural-analysis" title="Permalink to this headline">¶</a></h2>
<p>As part of the model loading procedure, <tt class="docutils literal"><span class="pre">doLoad()</span></tt> automatically performs
a stoichiometric (structural) analysis of the model. The structural
properties of the model are captured in stoichiometric matrix (<strong>N</strong>),
kernel matrix (<strong>K</strong>) and link matrix (<strong>L</strong>). These matrices can
either be displayed with a <tt class="docutils literal"><span class="pre">mod.showX()</span></tt> method or used in further
calculations as numeric arrays. The formal definition of these matrices,
as they are used in PySCeS, is described in <a class="footnote-reference" href="#id9" id="id3">[1]</a>.</p>
<p>The structural properties of a model are available in two
forms, as new-style objects which have all the array properties
neatly encapsulated or as legacy attributes. Although both
exist it is highly recommended to use the new objects.</p>
<div class="section" id="structural-analysis-new-objects">
<h3>Structural Analysis - new objects<a class="headerlink" href="#structural-analysis-new-objects" title="Permalink to this headline">¶</a></h3>
<p>For alternate descriptions of these model properties see the
next (legacy) section.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.Nmatrix</span></tt> view with <tt class="docutils literal"><span class="pre">mod.showN()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.Nrmatrix</span></tt> view with <tt class="docutils literal"><span class="pre">mod.showNr()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.Lmatrix</span></tt> view with <tt class="docutils literal"><span class="pre">mod.showK()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.L0matrix</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.Kmatrix</span></tt> view with <tt class="docutils literal"><span class="pre">mod.showL()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.K0matrix</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.showConserved()</span></tt> displays any moiety conserved relationships (if present).</li>
<li><tt class="docutils literal"><span class="pre">mod.showFluxRelationships()</span></tt> shows the relationships
between dependent and independent fluxes at steady state.</li>
</ul>
<p>All new structural objects have an <em>array</em> attribute which
holds the actual NumPy array data as well as <em>ridx</em> and <em>cidx</em>
which hold the row and column indexes (relative to the
stoichiometric matrix) as well as the following methods:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">.getLabels()</span></tt> return the matrix labels as tuple([rows], [columns])</li>
<li><tt class="docutils literal"><span class="pre">.getColsByName()</span></tt> extract column(s) with label</li>
<li><tt class="docutils literal"><span class="pre">.getRowsByName()</span></tt> extract row(s) with label</li>
<li><tt class="docutils literal"><span class="pre">.getIndexes()</span></tt> return the matrix indices (relative to the
Stoichiometric matrix) as tuple((rows), (columns))</li>
<li><tt class="docutils literal"><span class="pre">.getColsByIdx()</span></tt> extract column(s) referenced by index</li>
<li><tt class="docutils literal"><span class="pre">.getRowsByIdx()</span></tt> extract row(s) referenced by index</li>
</ul>
</div>
<div class="section" id="structural-analysis-legacy">
<h3>Structural Analysis - legacy<a class="headerlink" href="#structural-analysis-legacy" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.nmatrix</span></tt>, <strong>N</strong>: displayed with <tt class="docutils literal"><span class="pre">mod.showN()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.kmatrix</span></tt>, <strong>K</strong>: displayed with <tt class="docutils literal"><span class="pre">mod.showK()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.lmatrix</span></tt>, <strong>L</strong>: displayed with <tt class="docutils literal"><span class="pre">mod.showL()</span></tt> (an identity
matrix means <strong>L</strong> does not exist i.e. no linear dependence).</li>
<li>If there are linear dependencies in the differential equations then the
reduced stoichiometric matrix of linearly independent, differential
equations <strong>Nr</strong> is available as <tt class="docutils literal"><span class="pre">mod.nrmatrix</span></tt> and is displayed with
<tt class="docutils literal"><span class="pre">mod.showNr()</span></tt>. If there is no dependence <strong>Nr</strong> = <strong>N</strong>.</li>
<li>In the case where there is linear dependence the moiety conservation sums
can be displayed by using <tt class="docutils literal"><span class="pre">mod.showConserved()</span></tt>. The conservation totals
are calculated from the initial values of the variable species as defined
in the model file.</li>
<li>When the <strong>K</strong> and <strong>L</strong> matrices exist, their dependent parts
(<strong>K0</strong>, <strong>L0</strong>) are available as <tt class="docutils literal"><span class="pre">mod.kzeromatrix</span></tt> and
<tt class="docutils literal"><span class="pre">mod.lzeromatrix</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">mod.showConserved()</span></tt> prints any moiety conserved relationships (if
present).</li>
<li><tt class="docutils literal"><span class="pre">mod.showFluxRelationships()</span></tt> shows the relationships between dependent
and independent fluxes at steady state.</li>
</ul>
<p>If the <tt class="docutils literal"><span class="pre">mod.showX()</span></tt> methods are used the row and column titles of the
various matrices are displayed with the matrix. Additionally, all of the
<tt class="docutils literal"><span class="pre">mod.showX()</span></tt> methods accept an open file object as an argument. If this
file argument is present the method&#8217;s results are output to a file and not
printed to the screen. Alternatively, the order of each matrix dimension,
relative to the stoichiometric matrix, is available as either a row or
column array (e.g., <tt class="docutils literal"><span class="pre">mod.krow</span></tt>, mod.lrow``, <tt class="docutils literal"><span class="pre">mod.kzerocol</span></tt>).</p>
</div>
</div>
<div class="section" id="time-simulation">
<h2>Time simulation<a class="headerlink" href="#time-simulation" title="Permalink to this headline">¶</a></h2>
<p>PySCeS has interfaces to two ODE solvers either LSODA from
ODEPACK (part of SciPy) or SUNDIALS CVODE (using PySundials).
If PySundials is installed it will automatically select CVODE
if compartments, events or rate rules are detected during model
load as LSODA is not able capable of event handling or changing
compartment sizes. If, however, you would like to select the
solver manually this is also possible:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span><span class="o">.</span><span class="n">mode_integrator</span> <span class="o">=</span> <span class="s">&#39;LSODA&#39;</span>
<span class="n">mod</span><span class="o">.</span><span class="n">mode_integrator</span> <span class="o">=</span> <span class="s">&#39;CVODE&#39;</span>
</pre></div>
</div>
<p>There are three ways of running a simulation:</p>
<ol class="arabic">
<li><p class="first">Defining the <em>start</em>, <em>end</em> time and number of <em>points</em> and using the
<tt class="docutils literal"><span class="pre">mod.Simulate()</span></tt> method directly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span><span class="o">.</span><span class="n">sim_start</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">mod</span><span class="o">.</span><span class="n">sim_end</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mod</span><span class="o">.</span><span class="n">sim_points</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">mod</span><span class="o">.</span><span class="n">Simulate</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Using the <tt class="docutils literal"><span class="pre">mod.doSim()</span></tt> method where only the <em>end</em> time and <em>points</em>
need to be specified. For example running a 20 point simulation from time
0 to 10:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">doSim</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Or using <tt class="docutils literal"><span class="pre">mod.doSimPlot()</span></tt> which runs the simulation and displays the
results. In addition to doSim&#8217;s arguments the following arguments may
be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span><span class="o">.</span><span class="n">doSimPlot</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="s">&#39;species&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><em>plot</em> can be one of species, rates or all.</li>
<li><em>fmt</em> plot format, UPI backend dependent (default=&#8217;&#8216;) or the <em>CommonStyle</em> &#8216;lines&#8217; or &#8216;points&#8217;.</li>
<li><em>filename</em> if not None (default) then the plot is exported as <em>filename</em>.png</li>
</ul>
</li>
</ol>
<p>Another way of quickly visualising the results of a simulation
is to use the <tt class="docutils literal"><span class="pre">mod.SimPlot</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span><span class="o">.</span><span class="n">SimPlot</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="s">&#39;species&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><em>plot</em>: output to plot (default=&#8217;species&#8217;)</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>&#8216;all&#8217; rates and species</li>
<li>&#8216;species&#8217; species</li>
<li>&#8216;rates&#8217; reaction rates</li>
<li><cite>[&#8216;S1&#8217;, &#8216;R1&#8217;, ]</cite> a list of model attributes (species, rates)</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><em>filename</em> (optional) if not None file is exported to filename (default=None)</li>
<li><em>title</em> the plot title (default=None)</li>
<li><em>log</em> use log axis for &#8216;x&#8217;, &#8216;y&#8217;, &#8216;xy&#8217; (default=None)</li>
<li><em>fmt</em> plot format, UPI backend dependent (default=&#8217;&#8216;) or the <em>CommonStyle</em> &#8216;lines&#8217; or &#8216;points&#8217;.</li>
</ul>
<p>Called without arguments, <tt class="docutils literal"><span class="pre">mod.SimPlot()</span></tt> plots all the species
concentrations against time.</p>
<div class="section" id="simulation-results">
<h3>Simulation results<a class="headerlink" href="#simulation-results" title="Permalink to this headline">¶</a></h3>
<p>In PySCeS 0.7.x the simulation results have been consolidated
into a new <tt class="docutils literal"><span class="pre">mod.data_sim</span></tt> object. By default species
concentrations/amounts, reaction rates and rate rules are
automatically added to the <em>data_sim</em> object. If extra
information (parameters, compartments, assignment rules) is
required this can easily be added using <tt class="docutils literal"><span class="pre">mod.CVODE_extra_output</span></tt>, a
list containing any model attribute which is not added by default.</p>
<p>The <tt class="docutils literal"><span class="pre">mod.data_sim</span></tt> object which has many methods for extracting simulation
data including:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getTime()</span></tt> return a vector of time points</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getSpecies()</span></tt> returns array([[time], [species]])</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getRates()</span></tt> returns array([[time], [rates]])</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getRules()</span></tt> returns array([[time], [rate rules]])</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getXData</span></tt> returns array([[time], [CVODE_extra_output]])</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getSimData(*args)</span></tt> return an array consisting of <em>time</em> plus any
available data series:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mod</span><span class="o">.</span><span class="n">data_sim</span><span class="o">.</span><span class="n">getSimdata</span><span class="p">(</span><span class="s">&#39;s1&#39;</span><span class="p">,</span> <span class="s">&#39;R1&#39;</span><span class="p">,</span> <span class="s">&#39;Rule1&#39;</span><span class="p">,</span> <span class="s">&#39;xData2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getAllSimData(*args)</span></tt> return an array of all simulation data</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getDataAtTime(time)</span></tt> return the results of the simulation at
<em>time</em>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">data_sim.getDataInTimeInterval(time,</span> <span class="pre">bound)</span></tt> return the simulation
data in the interval [time-bound, time+bound], if <em>bound</em> is not
specified it is assumed to be the step size.</p>
</li>
</ul>
<p>All the <em>data_sim.get*</em> methods by default only return a NumPy array containing
the requested data, however if the argument <em>lbls</em> is set to True then both
the array as well as a list of column labels is returned:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Sdata</span><span class="p">,</span> <span class="n">Slabels</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">data_sim</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">lbls</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>This is very useful when using the PySCeS plotting interface
(described later in this guide) to plot simulation results.</p>
</div>
<div class="section" id="id4">
<h3>Advanced<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>PySCeS sets integrator options that attempt to configure the integration
algorithms to suit a particular model. However, almost every integrator
option can be overridden by the user.
Simulator settings are stored in PySCeS <tt class="docutils literal"><span class="pre">mod.__settings__</span></tt>
dictionary. For LSODA some useful keys are
(mod.__settings__[<em>key</em>]):</p>
<div class="highlight-python"><pre>'lsoda_atol': 1.0e-012
'lsoda_rtol': 1.0e-007
'lsoda_mxordn': 12
'lsoda_mxords': 5
'lsoda_mxstep': 0</pre>
</div>
<p>atol and rtol are the absolute and relative tolerances, while mxstep=0
means that LSODA chooses the number of steps (up to 500). If this is
still not enough, PySCeS automatically increases the number of steps
necessary to find a solution.</p>
<p>Additionally, CVODE allows per step step-size optimisation and automatic
tolerance scaling:</p>
<div class="highlight-python"><pre>'cvode_abstol': 1.0e-15
'cvode_abstol_factor': 1.0e-8
'cvode_auto_tol_adjust': True
'cvode_mxstep': 1000
'cvode_reltol': 1.0e-9
'cvode_stats': False</pre>
</div>
<p><em>cvode_abstol</em> is considered to be the minimum absolute
tolerance, PySCeS first uses the initial species values
multiplied by <em>cvode_abstol_factor</em> (so that [s]*[factor] &gt;= [abstol])
to calculate its absolute tolerance. Once the simulation is
underway PySCeS periodically readjusts the absolute tolerance
on a per species basis based on the current species value.</p>
<p>If CVODE cannot find a solution in the given number of steps it
automatically increases <em>cvode_mxstep</em> and tries again,
however, it also keeps track of the number of times that this
adjustment is required and if a specific threshold is passed it
will begin to increase <em>cvode_reltol</em> by 1.0e3 (to a maximal
value of 1.0e-3). Finally, if <em>cvode_stats</em> is enabled CVODE will
display a report of its internal parameters after the
simulation is complete.</p>
</div>
</div>
<div class="section" id="steady-state-analysis">
<h2>Steady-state analysis<a class="headerlink" href="#steady-state-analysis" title="Permalink to this headline">¶</a></h2>
<p>PySCeS solves for a steady state using either the non-linear solvers
<a class="reference external" href="http://www.netlib.org">HYBRD</a>,  <a class="reference external" href="http://www.zib.de/SciSoft/ANT/nleq2.en.html">NLEQ2</a> or forward integration. By default PySCeS has <em>solver
fallback</em> enabled which means that if a solver fails or returns an invalid
result (i.e., contains negative concentrations) it switches to the next
available solver. The solver chain is as follows:</p>
<ol class="arabic simple">
<li>HYBRD (can handle &#8216;rough&#8217; initial conditions, converges quickly).</li>
<li>NLEQ2 (highly optimised for extremely non-linear systems,
more sensitive to bad conditioning and slightly slower convergence).</li>
<li>FINTSLV (finds a result when the change in max([species]) is less than 0.1%;
slow convergence).</li>
</ol>
<p>Solver fallback can be disabled by setting <tt class="docutils literal"><span class="pre">mod.mode_solver_fallback</span> <span class="pre">=</span>
<span class="pre">0</span></tt>. Each of the three solvers is highly configurable and although the
default settings should work for most models configurable options
can be set in by way of the <em>mod.__settings__</em> dictionary.</p>
<p>To calculate a steady state use the <tt class="docutils literal"><span class="pre">mod.doState()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">doState</span><span class="p">()</span>
<span class="go">(hybrd) The solution converged.</span>
</pre></div>
</div>
<p>The results of a steady-state evaluation are stored as arrays as well as
individual attributes and can be easily displayed using the
<tt class="docutils literal"><span class="pre">mod.showState()</span></tt> method:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.showState()</span></tt> displays the current steady-state values of both the
species and fluxes.</li>
<li>For each reaction (e.g. <tt class="docutils literal"><span class="pre">R2</span></tt>) a new attribute <tt class="docutils literal"><span class="pre">mod.J_R2</span></tt>, which
represents its steady-state value, is created.</li>
<li>Similarly, each species (e.g. <tt class="docutils literal"><span class="pre">mod.s2</span></tt>) has a steady-state attribute
<tt class="docutils literal"><span class="pre">mod.s2_ss</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.state_species</span></tt> in <tt class="docutils literal"><span class="pre">mod.species</span></tt> order.</li>
<li><tt class="docutils literal"><span class="pre">mod.state_flux</span></tt> in <tt class="docutils literal"><span class="pre">mod.reactions</span></tt> order.</li>
</ul>
<p>There are various ways of initialising the steady-state solvers although,
in general, the default values can be used.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.mode_state_init</span></tt> initialises the solver using either the initial
values (0), a value close to zero (1). The default behaviour
is to use the initial values.</li>
</ul>
<div class="section" id="new-mod-data-sstate">
<h3>New: mod.data_sstate<a class="headerlink" href="#new-mod-data-sstate" title="Permalink to this headline">¶</a></h3>
<p>New to PySCeS 0.7 is the <tt class="docutils literal"><span class="pre">mod.data_sstate</span></tt> object that by
default stores steady-state data (species, fluxes, rate rules)
in a manner similar to mod.data_sim. One notable exception is
that the current steady-state values are also made available as
attributes to this object (e.g. species S1&#8217;s steady-state value
is stored as <tt class="docutils literal"><span class="pre">mod.data_sstate.S1</span></tt>). Using the
<tt class="docutils literal"><span class="pre">mod.STATE_extra_output</span></tt> list it is possible to store user
defined data in the <em>data_sstate</em> object. Steady-state data can be
easily retrieved using the by now familiar <em>.get*</em> methods.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">data_sstate.getSpecies()</span></tt> returns a species array</li>
<li><tt class="docutils literal"><span class="pre">data_sstate.getFluxes()</span></tt> returns a flux array</li>
<li><tt class="docutils literal"><span class="pre">data_sstate.getRules()</span></tt> returns a rate rule array</li>
<li><tt class="docutils literal"><span class="pre">data_sstate.getXData()</span></tt> returns an array defined in <em>STATE_extra_output</em></li>
<li><tt class="docutils literal"><span class="pre">data_sstate.getStateData(*args)</span></tt> return user defined array of data (&#8216;S1&#8217;,&#8217;R2&#8217;)</li>
<li><tt class="docutils literal"><span class="pre">data_sstate.getAllStateData()</span></tt> return all state data as an array</li>
</ul>
<p>All these methods also accept the lbls=True argument in which case they return both
array data and a label list:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssdat</span><span class="p">,</span> <span class="n">sslbl</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">data_sstate</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">(</span><span class="n">lbls</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="stability">
<h3>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h3>
<p>PySCeS can analyse the stability of systems that can attain a steady state.
It does this by calculating the Eigen values of the Jacobian matrix for the
reduced system of independent ODE&#8217;s:</p>
<div class="highlight-python"><pre>- ``mod.doEigen()`` calculates a steady-state and performs the stability analysis
- ``mod.showEigen`` prints out a stability report
- ``mod.doEigenShow()`` combines both of the above</pre>
</div>
<p>The Eigen values are also available as attributes
<tt class="docutils literal"><span class="pre">mod.lambda1</span></tt> etc. By default the Eigen values are stored as
<tt class="docutils literal"><span class="pre">mod.eigen_values</span></tt> but if
<tt class="docutils literal"><span class="pre">mod.__settings__['mode_eigen_output']</span> <span class="pre">=</span> <span class="pre">1</span></tt> is set both the
Eigen values as well as the left and right Eigen vectors are
stored as <tt class="docutils literal"><span class="pre">mod.eigen_vecleft</span></tt> and <tt class="docutils literal"><span class="pre">mod.eigen_vecright</span></tt>
respectively. Please note that there is currently no guarantee
that the order of the Eigen value array corresponds to the
species order.</p>
</div>
</div>
<div class="section" id="metabolic-control-analysis">
<h2>Metabolic Control Analysis<a class="headerlink" href="#metabolic-control-analysis" title="Permalink to this headline">¶</a></h2>
<p>For practical purposes the following methods are collected into a set of
meta-routines that all first solve for a steady state and then the required
Metabolic Control Analysis (MCA) <a class="footnote-reference" href="#id10" id="id5">[2]</a>, <a class="footnote-reference" href="#id11" id="id6">[3]</a> evaluation methods.</p>
<div class="section" id="elasticities">
<h3>Elasticities<a class="headerlink" href="#elasticities" title="Permalink to this headline">¶</a></h3>
<p>The elasticities towards both the variable species and parameters can be
calculated using <tt class="docutils literal"><span class="pre">mod.doElas()</span></tt> which generates as output:</p>
<ul class="simple">
<li>Scaled elasticities generated as <tt class="docutils literal"><span class="pre">mod.ecRate_Species</span></tt>, e.g.
<tt class="docutils literal"><span class="pre">mod.ecR4_s2</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mod.showEvar()</span></tt> displays the non-zero elasticities calculated with
respect to the variable species.</li>
<li><tt class="docutils literal"><span class="pre">mod.showEpar()</span></tt> displays the non-zero parameter elasticities.</li>
</ul>
<p>As a prototype we also store the elasticities in an object,
<tt class="docutils literal"><span class="pre">mod.ec.*</span></tt> this may become the default way of accessing
elasticity data in future releases but has not been stabilised
yet.</p>
</div>
<div class="section" id="control-coefficients">
<h3>Control coefficients<a class="headerlink" href="#control-coefficients" title="Permalink to this headline">¶</a></h3>
<p>Both control coefficients and elasticities can be calculated using a single
method, <tt class="docutils literal"><span class="pre">mod.doMca()</span></tt>.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.showCC()</span></tt> displays the complete set of flux and concentration
control coefficients.</li>
<li>Individual control coefficients are generated as either
<tt class="docutils literal"><span class="pre">mod.ccSpecies_Rate</span></tt> for a concentration control coefficient, e.g.
<tt class="docutils literal"><span class="pre">mod.ccs1_R4</span></tt>.</li>
<li>Similarly, <tt class="docutils literal"><span class="pre">mod.ccJFlux_Rate</span></tt> is a flux control coefficient e.g.
<tt class="docutils literal"><span class="pre">mod.ccJR1_R4</span></tt>.</li>
</ul>
<p>As it is generally common practice to use scaled elasticities
and control coefficients PySCeS calculated these by default.
However, it is possible to generate unscaled elasticities and
control coefficients by setting the attribute
<tt class="docutils literal"><span class="pre">mod.__settings__['mode_mca_scaled']</span> <span class="pre">=</span> <span class="pre">0</span></tt> in which case the
model attributes are attached as <tt class="docutils literal"><span class="pre">mod.uec</span></tt> and <tt class="docutils literal"><span class="pre">mod.ucc</span></tt>
respectively.</p>
<p>As a prototype we also store the elasticities in an object,
<tt class="docutils literal"><span class="pre">mod.cc.*</span></tt> this may become the default way of accessing
control coefficient data in future releases but has not been
stabilised yet.</p>
</div>
<div class="section" id="response-coefficients">
<h3>Response coefficients<a class="headerlink" href="#response-coefficients" title="Permalink to this headline">¶</a></h3>
<p>A new PySCeS feature is the ability to calculate the parameter response
coefficients for a model with the <tt class="docutils literal"><span class="pre">mod.doMcaRC()</span></tt> method. Unlike the
elasticities and control coefficients the response coefficients are made
available as a single attribute <tt class="docutils literal"><span class="pre">mod.rc</span></tt>. This attribute is a data
object, containing the response coefficients as attributes and has the
following methods:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">rc.var_par</span></tt> individual response coefficients can be accessed as
attributes made up of <tt class="docutils literal"><span class="pre">variable_parameter</span></tt> e.g. <tt class="docutils literal"><span class="pre">mod.rc.R1_k1</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rc.get('var',</span> <span class="pre">'par')</span></tt> return a response coefficient</li>
<li><tt class="docutils literal"><span class="pre">rc.list()</span></tt> returns all response coefficients as a dictionary of
{key:value} pairs</li>
<li><tt class="docutils literal"><span class="pre">rc.select('attr',</span> <span class="pre">search='a')</span></tt> select all response coefficients that
refer to <tt class="docutils literal"><span class="pre">'attr'</span></tt> e.g. <tt class="docutils literal"><span class="pre">select('R1')</span></tt> or <tt class="docutils literal"><span class="pre">select('k2')</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rc.matrix</span></tt>: the matrix of response coefficients</li>
<li><tt class="docutils literal"><span class="pre">rc.row</span></tt>: row labels</li>
<li><tt class="docutils literal"><span class="pre">rc.col</span></tt>: column labels</li>
</ul>
</div>
<div class="section" id="responce-coefficients-with-respect-to-moiety-conserved-sums">
<h3>Responce coefficients with respect to moiety-conserved sums<a class="headerlink" href="#responce-coefficients-with-respect-to-moiety-conserved-sums" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">mod.doMcaRC()</span></tt> method only calculates response coefficients with respect to explicit model parameters. However, in models with moiety-conservation the total concentration of all the species that form part of a particular moiety-conserved cycle is also a parameter of the model. PySCeS infers such moiety-conserved sums from the initial species concentrations specified by the user. In some cases it might be interesting to consider the effects that a change in the total concentration of a moiety will have on the steady-state. This analysis may be done with the method <tt class="docutils literal"><span class="pre">mod.doMcaRCT()</span></tt>.</p>
<p>Since moiety-conserved sums are not explicitly named in PySCeS model files, <tt class="docutils literal"><span class="pre">'T_'</span></tt> is prepended to all the species names listed in <tt class="docutils literal"><span class="pre">mod.Consmatrix.row</span></tt>. For instance, if the dependent species in a moiety-conserved cycle is <tt class="docutils literal"><span class="pre">'A'</span></tt>, then <tt class="docutils literal"><span class="pre">'T_A'</span></tt> designates the moiety-conserved sum.</p>
<p>The object <tt class="docutils literal"><span class="pre">mod.rc</span></tt> is augmented with the results of <tt class="docutils literal"><span class="pre">mod.doMcaRCT()</span></tt>. Response coefficients may thus be accessed with <tt class="docutils literal"><span class="pre">mod.rc.get('var',</span> <span class="pre">'T_par')</span></tt>.</p>
</div>
</div>
</div>
<div class="section" id="parameter-scanning">
<span id="analysis"></span><h1>Parameter scanning<a class="headerlink" href="#parameter-scanning" title="Permalink to this headline">¶</a></h1>
<div class="section" id="single-dimension-parameter-scans">
<h2>Single dimension parameter scans<a class="headerlink" href="#single-dimension-parameter-scans" title="Permalink to this headline">¶</a></h2>
<p>PySCeS has the ability to quickly generate and plot single dimension
parameter scans. Scanning a parameter typically involves changing a
parameter through a range of values and recalculating the steady state at
each step. Two methods are provided which simplify this task,
<tt class="docutils literal"><span class="pre">mod.Scan1()</span></tt> is provided to generate the scan data while
<tt class="docutils literal"><span class="pre">mod.Scan1Plot()</span></tt> is used to visualise the results. The first step is to
define the scan parameters:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">mod.scan_in</span></tt> is a string defining the parameter to be scanned e.g.
<tt class="docutils literal"><span class="pre">'x0'</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mod.scan_out</span></tt> is a list of strings representing the attribute names
you would like to track in the output eg.
<tt class="docutils literal"><span class="pre">['J_R1','J_R2','s1_ss','s2_ss']</span></tt></p>
</li>
<li><p class="first">You also need to define the range of points that you would like to scan
over. For a linear range SciPy has a useful function
<tt class="docutils literal"><span class="pre">scipy.linspace(start,</span> <span class="pre">end,</span> <span class="pre">points)</span></tt> (SciPy can be accessed by typing
<tt class="docutils literal"><span class="pre">import</span> <span class="pre">scipy</span></tt> in your Python shell). If you need to generate a log range
use <tt class="docutils literal"><span class="pre">scipy.logspace(start,</span> <span class="pre">end,</span> <span class="pre">points)</span></tt>.</p>
<p>Both <tt class="docutils literal"><span class="pre">scipy.linspace</span></tt> and <tt class="docutils literal"><span class="pre">scipy.logspace</span></tt> use the number of points
(including the start and end points) in the interval as an input.
Additionally, the start and end values of <tt class="docutils literal"><span class="pre">scipy.logspace</span></tt> must be
entered as indices, e.g. to start the range at 0.1 and end it at 100 you
would write <tt class="docutils literal"><span class="pre">scipy.logspace(-1,</span> <span class="pre">2,</span> <span class="pre">steps)</span></tt>. Setting up a PySCeS scan
session might look something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">scan_in</span> <span class="o">=</span> <span class="s">&#39;x0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">scan_out</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;J_R1&#39;</span><span class="p">,</span><span class="s">&#39;J_R6&#39;</span><span class="p">,</span><span class="s">&#39;s2_ss&#39;</span><span class="p">,</span><span class="s">&#39;s7_ss&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scan_range</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Before starting the parameter scan, it is important to check that all the
model attributes involved in the scan do actually exist. For example,
<tt class="docutils literal"><span class="pre">mod.J_R1</span></tt> is created when <tt class="docutils literal"><span class="pre">mod.doState()</span></tt> is executed, likewise all
the elasticities (<tt class="docutils literal"><span class="pre">mod.ecR_S</span></tt>) and control coefficients (<tt class="docutils literal"><span class="pre">mod.ccJ_R</span></tt>)
are only created when the <tt class="docutils literal"><span class="pre">mod.doMca()</span></tt> method is called. If all the
attributes exist you can perform a parameter scan using the
<tt class="docutils literal"><span class="pre">mod.Scan1(scan_range)</span></tt> method which takes your predefined scan range as
an argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Scan1</span><span class="p">(</span><span class="n">scan_range</span><span class="p">)</span>

<span class="go">Scanning ...</span>
<span class="go">11 (hybrd) The solution converged.</span>
<span class="go">(hybrd) The solution converged ...</span>

<span class="go">done.</span>
</pre></div>
</div>
<p>When the scan has been successfully completed, the results are stored in
the array (<tt class="docutils literal"><span class="pre">mod.scan_res</span></tt>) that has <tt class="docutils literal"><span class="pre">mod.scan_in</span></tt> as its first column
followed by columns that represent the data defined in <tt class="docutils literal"><span class="pre">mod.scan_out</span></tt> (if
invalid steady states are generated during the scan they are replaced by
NaN). Scan1 also reports the scan parameter values which generated the
invalid states.} . If one or more of your input or output parameters is not
a valid model attribute, it will be ignored. Once the parameter scan data
has been generated, the next step is to visualise it using the
<tt class="docutils literal"><span class="pre">mod.Scan1Plot()</span></tt> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Scan1Plot</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="p">[],</span> <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><em>plot</em> if empty mod.scan_out is used, otherwise any subset of mod.scan_out (default=[])</li>
<li><em>filename</em> the filename of the PNG file (default=None, no export)</li>
<li><em>title</em> the plot title (default=None)</li>
<li><em>log</em> if None a linear axis is assumed otherwise one of [&#8216;x&#8217;,&#8217;xy&#8217;,&#8217;xyz&#8217;] (default=None)</li>
<li><em>format</em> the backend dependent line format (default=&#8217;lines&#8217;)  or the <em>CommonStyle</em> &#8216;lines&#8217; or &#8216;points&#8217;.</li>
</ul>
<p>Called without any arguments Scan1Plot plots all of <em>mod.sim_out</em> against <em>mod.sim_in</em>.</p>
</div>
<div class="section" id="two-dimension-parameter-scans">
<h2>Two dimension parameter scans<a class="headerlink" href="#two-dimension-parameter-scans" title="Permalink to this headline">¶</a></h2>
<p>Two dimension parameter scans can also easily be generated using the <tt class="docutils literal"><span class="pre">mod.Scan2D</span></tt>
method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Scan2D</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><em>p1</em> is a list of [model parameter 1, start value, end value, points]</li>
<li><em>p2</em> is a list of [model parameter 2, start value, end value, points]</li>
<li><em>output</em> the steady-state variable e.g. &#8216;J_R1&#8217; or &#8216;A_ss&#8217;</li>
<li><em>log</em> if True scan using log ranges for both axes</li>
</ul>
<p>To plot the results of two dimensional scan use the <tt class="docutils literal"><span class="pre">mod.Scan2DPlot</span></tt> method. Note
that as Matplotlib cannot produce 3D plots the GnuPlot interface must be active
(see the section on plotting later on in this guide):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Scan2DPlot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><em>filename</em> the filename of the PNG file (default=None, no export)</li>
<li><em>title</em> the plot title (default=None)</li>
<li><em>log</em> if None a linear axis is assumed otherwise one of [&#8216;x&#8217;,&#8217;xy&#8217;,&#8217;xyz&#8217;] (default=None)</li>
<li><em>format</em> the backend dependent line format (default=&#8217;lines&#8217;)  or the <em>CommonStyle</em> &#8216;lines&#8217; or &#8216;points&#8217;.</li>
</ul>
</div>
<div class="section" id="multi-dimension-parameter-scans">
<h2>Multi-dimension parameter scans<a class="headerlink" href="#multi-dimension-parameter-scans" title="Permalink to this headline">¶</a></h2>
<p>This new PySCeS feature allows multi-dimensional parameter scanning. Any
combination of parameters is possible and can be added as <em>master</em>
parameters that change independently or <em>slave</em> parameters whose change is
coordinated with the previously defined parameter. Unlike <tt class="docutils literal"><span class="pre">mod.Scan1()</span></tt>
this function is accessed via the <tt class="docutils literal"><span class="pre">pysces.Scanner</span></tt> class that is
instantiated with a loaded PySCeS model object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span> <span class="o">=</span> <span class="n">pysces</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span><span class="o">.</span><span class="n">addScanParameter</span><span class="p">(</span><span class="s">&#39;x3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span><span class="o">.</span><span class="n">addScanParameter</span><span class="p">(</span><span class="s">&#39;k2&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span><span class="o">.</span><span class="n">addScanParameter</span><span class="p">(</span><span class="s">&#39;k4&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">slave</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span><span class="o">.</span><span class="n">addUserOutput</span><span class="p">(</span><span class="s">&#39;J_R1&#39;</span><span class="p">,</span> <span class="s">&#39;s1_ss&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>

<span class="gp">... </span><span class="n">scan</span><span class="p">:</span> <span class="mi">55</span> <span class="n">states</span> <span class="n">analysed</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sc1_res</span> <span class="o">=</span> <span class="n">sc1</span><span class="o">.</span><span class="n">getResultMatrix</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sc1_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([1., 0.1, 0.1, 97.94286647, 49.1380999])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">sc1_res</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([1.0e+01, 1.0e+03, 1.0e+03, -3.32564878e+00, 3.84227702e-03])</span>
</pre></div>
</div>
<p>In this scan we define two independent (<tt class="docutils literal"><span class="pre">x3,</span> <span class="pre">k2</span></tt>) and one dependent
(<tt class="docutils literal"><span class="pre">k3</span></tt>) scan parameters and track the changes in the steady state
variables <tt class="docutils literal"><span class="pre">J_R1</span></tt> and <tt class="docutils literal"><span class="pre">s1_ss</span></tt>. Note that <tt class="docutils literal"><span class="pre">k2</span></tt> and <tt class="docutils literal"><span class="pre">k4</span></tt> use a
logarithmic scale. Once run the input parameters cannot be altered,
however, the output can be changed and the scan rerun.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">sc1.addScanParameter(name,</span> <span class="pre">start,</span> <span class="pre">end,</span> <span class="pre">points,</span> <span class="pre">log,</span> <span class="pre">slave)</span></tt> where
<tt class="docutils literal"><span class="pre">name</span></tt> is the input parameter (as a string), <tt class="docutils literal"><span class="pre">start</span></tt> and <tt class="docutils literal"><span class="pre">end</span></tt> define
the range with the required number of <tt class="docutils literal"><span class="pre">points</span></tt>. While <tt class="docutils literal"><span class="pre">log</span></tt> and
<tt class="docutils literal"><span class="pre">slave</span></tt> are boolean arguments indicating the point distribution and
whether the axis is independent or not.</li>
<li><tt class="docutils literal"><span class="pre">sc1.addUserOutput(*args)</span></tt> an arbitrary number of model attributes to
be output can be added (this method automatically tries to determine the
level of analysis necessary) e.g. <tt class="docutils literal"><span class="pre">addUserOutput('J_R1',</span> <span class="pre">'ecR1_k2')</span></tt></li>
<li><tt class="docutils literal"><span class="pre">sc1.Run()</span></tt> run the scan, if subsequent runs are required after
changing output parameters use <tt class="docutils literal"><span class="pre">sc1.RunAgain()</span></tt>. Note that it is not
possible to change the input parameters once a scan has been run, if this
is required a new Scanner object should be created.</li>
<li><tt class="docutils literal"><span class="pre">sc1.getResultMatrix(stst=False)</span></tt> return the scan results as an array containing
both input and output if <em>stst = True</em> append the
steady-state fluxes and concentrations to the user output so
that output has dimensions [scan_parameters]+[state_species+state_flux]+[Useroutput]
otherwise return the default [scan_parameters]+[Useroutput].</li>
<li><tt class="docutils literal"><span class="pre">sc1.UserOutputList</span></tt> the list of output names</li>
<li><tt class="docutils literal"><span class="pre">sc1.UserOutputResults</span></tt> an array containing only the output</li>
<li><tt class="docutils literal"><span class="pre">sc1.ScanSpace</span></tt> the generated list of input parameters.</li>
</ul>
</div>
</div>
<div class="section" id="plotting">
<span id="id7"></span><h1>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h1>
<p>The PySCeS plotting interface has been completely rewritten to
facilitate the use of multiple plotting back-ends via a Unified
Plotting Interface (UPI). Using the UPI we ensure that a
specified subset of plotting methods is back-end independent
(although the UPI can be extended with back-end specific
methods). So far Matplotlib (default) and GnuPlot back-ends
have been implemented.</p>
<p>The common UPI functionality is accessible as <tt class="docutils literal"><span class="pre">pysces.plt.*</span></tt>
while back-end specific functionality is available as
<tt class="docutils literal"><span class="pre">pysces.plt.m</span></tt> (Matplotlib) and <tt class="docutils literal"><span class="pre">pysces.plt.g</span></tt> (GnuPlot).</p>
<p>While the Matplotlib is activated by default GnuPlot needs to
be enabled (see Configuring PySCeS section) and then activated
using <tt class="docutils literal"><span class="pre">pysces.plt.p_activateInterface('gnuplot')</span></tt>. All
installed interfaces can be activated or deactivated as
required:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pysces</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">p_activateInterface</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pysces</span><span class="o">.</span><span class="n">plt</span><span class="o">.</span><span class="n">p_deactivateInterface</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>
</pre></div>
</div>
<p>where <em>interface</em> is either <em>&#8216;matplotlib&#8217;</em> or <em>&#8216;gnuplot&#8217;</em>. The
PySCeS UPI defines currently has the following methods:</p>
<p><tt class="docutils literal"><span class="pre">plot(data,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">title='',</span> <span class="pre">format='')</span></tt> plot a single line data[y] vs data[x]</p>
<blockquote>
<div><ul class="simple">
<li><em>data</em> the data array</li>
<li><em>x</em> x column index</li>
<li><em>y</em> y column index</li>
<li><em>title</em> is the line key</li>
<li><em>format</em> is the backend format string (default=&#8217;&#8216;)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">plotLines(data,</span> <span class="pre">x,</span> <span class="pre">y=[],</span> <span class="pre">titles=[],</span> <span class="pre">formats=[''])</span></tt> plot multiple lines i.e. data[y1, y2, ] vs data[x]</p>
<blockquote>
<div><ul class="simple">
<li><em>data</em> the data array</li>
<li><em>x</em> x column index</li>
<li><em>y</em> is a list of line indexes, if empty all of y not including x is plotted</li>
<li><em>titles</em> a list of line keys, if empty Line1, Line2, etc is used</li>
<li><em>formats</em> a list (per line) of format strings, if formats only contains a single item, this format is used for all lines.</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">splot(data,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">title='',</span> <span class="pre">format='')</span></tt> plot a surface i.e. data[z] vs data[y] vs data[x]</p>
<blockquote>
<div><ul class="simple">
<li><em>data</em> the data array</li>
<li><em>x</em> x column index</li>
<li><em>y</em> y column index</li>
<li><em>z</em> z column index</li>
<li><em>title</em> the surface key</li>
<li><em>format</em> a format string (default=&#8217;&#8216;)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">splotSurfaces(data,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z=[],</span> <span class="pre">titles=[],</span> <span class="pre">formats=[''])</span></tt> plot multiple surfaces i.e. data[z1, z2, ] vs data[y] vs data[x]</p>
<blockquote>
<div><ul class="simple">
<li><em>data</em> the data array</li>
<li><em>x</em> x column index</li>
<li><em>y</em> y column index</li>
<li><em>z</em> a list of z column indexes, if empty all data not including x, y are plotted</li>
<li><em>titles</em> a list of surface keys, if empty Surf1, Surf2 etc. is used</li>
<li><em>formats</em> is a list (per line) of format strings (default=&#8217;&#8216;)</li>
</ul>
</div></blockquote>
<p>If formats only contains a single item, this format is used for all surfaces.</p>
<p><tt class="docutils literal"><span class="pre">replot()</span></tt> replot the current figure using all active interfaces (useful with GnuPlot type interfaces)</p>
<p><tt class="docutils literal"><span class="pre">save(name,</span> <span class="pre">directory=None,</span> <span class="pre">dfmt='\%.8e')</span></tt> save the plot data and (if possible) the back-end specific format file</p>
<blockquote>
<div><ul class="simple">
<li><em>filename</em> the filename</li>
<li><em>directory</em> optional (default = current working directory)</li>
<li><em>dfmt</em> the data format string (default=&#8217;%.8e&#8217;)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">export(name,</span> <span class="pre">directory=None,</span> <span class="pre">type='png')</span></tt> export the current plot as a &lt;format&gt; file (currently only PNG is guaranteed to be available on all back-ends).</p>
<blockquote>
<div><ul class="simple">
<li><em>filename</em> the filename</li>
<li><em>directory</em> optional (default = current working directory)</li>
<li><em>type</em> the file format (default=&#8217;png&#8217;).</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setGraphTitle(title='PySCeS</span> <span class="pre">Plot')</span></tt> set the graph title, unset if <em>title=None</em></p>
<blockquote>
<div><ul class="simple">
<li><em>title</em> (string, default=&#8217;PySCeS Plot&#8217;) the graph title</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setAxisLabel(axis,</span> <span class="pre">label='')</span></tt> sets one or more axis label</p>
<blockquote>
<div><ul class="simple">
<li><em>axis</em> x, y, z, xy, xz, yz, zyx</li>
<li><em>label</em> label string (default=None)</li>
</ul>
</div></blockquote>
<p>Called with only the axis argument clears that axis&#8217; label.</p>
<p><tt class="docutils literal"><span class="pre">setKey(value=False)</span></tt> enable or disable the current plot key, no arguments removes key.</p>
<blockquote>
<div><ul class="simple">
<li><em>value</em> boolean (default = False)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setLogScale(axis)</span></tt> set <em>axis</em> to log scale</p>
<blockquote>
<div><ul class="simple">
<li><em>axis</em> is one of x, y, z, xy, xz, yz, zyx</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setNoLogScale(axis)</span></tt> set axis to a linear scale</p>
<blockquote>
<div><ul class="simple">
<li><em>axis</em> is one of x, y, z, xy, xz, yz, zyx</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setRange(axis,</span> <span class="pre">min=None,</span> <span class="pre">max=None)</span></tt> set one or more axis range</p>
<blockquote>
<div><ul class="simple">
<li><em>axis</em> is one of x, y, z, xy, xz, yz, zyx</li>
<li><em>min</em> is the range(s) lower bound (default=None, back-end auto-scales)</li>
<li><em>max</em> range(s) upper bound (default=None, back-end auto-scales)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">setGrid(value)</span></tt> enable or disable the graph grid</p>
<blockquote>
<div><ul class="simple">
<li><em>value</em> (boolean) True (on) or False (off)</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">plt.closeAll()</span></tt> Close all active Matplolib figures</p>
</div>
<div class="section" id="displaying-data">
<span id="output"></span><h1>Displaying data<a class="headerlink" href="#displaying-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="displaying-saving-model-attributes">
<h2>Displaying/saving model attributes<a class="headerlink" href="#displaying-saving-model-attributes" title="Permalink to this headline">¶</a></h2>
<p>All of the <tt class="docutils literal"><span class="pre">showX()</span></tt> methods, with the exception of <tt class="docutils literal"><span class="pre">mod.showModel()</span></tt>
operate in exactly the same way. If called without an argument, they
display the relevant information to the screen. Alternatively, if given an
open, writable (ASCII mode) file object as an argument, they write the
requested information to the open file. This allows the generation of
customised reports containing only information relevant to the model.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mod.showSpecies()</span></tt> prints the current value of the model species
(mod.M).</li>
<li><tt class="docutils literal"><span class="pre">mod.showSpeciesI()</span></tt> prints the initial, parsed in, value of the model
species (mod.Mi).</li>
<li><tt class="docutils literal"><span class="pre">mod.showPar()</span></tt> prints the current value of the model parameters.</li>
<li><tt class="docutils literal"><span class="pre">mod.showState()</span></tt> prints the current steady-state fluxes and species.</li>
<li><tt class="docutils literal"><span class="pre">mod.showConserved()</span></tt> prints any moiety conserved relationships (if
present).</li>
<li><tt class="docutils literal"><span class="pre">mod.showFluxRelationships()</span></tt> shows the relationships between dependent
and independent fluxes at steady state</li>
<li><tt class="docutils literal"><span class="pre">mod.showRateEq()</span></tt> prints the reaction stoichiometry and rate equations.</li>
<li><tt class="docutils literal"><span class="pre">mod.showODE()</span></tt> prints the differential equations.</li>
</ul>
<p>Please note that the <tt class="docutils literal"><span class="pre">mod.showModel()</span></tt> method is not
recommended for saving models as a PySCeS input file instead
use the Core2 based <tt class="docutils literal"><span class="pre">pysces.interface.writeMod2PSC</span></tt> method
instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pysces</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">writeMod2PSC</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">iValues</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">getstrbuf</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><em>filename</em>: writes &lt;filename&gt;.psc or &lt;model_name&gt;.psc if None</li>
<li><em>directory</em>: (optional) an output directory</li>
<li><em>iValues</em>: if True (default) then the models initial values are used (or the current values if False).</li>
<li><em>getstrbuf</em>: if True a StringIO buffer is returned instead of writing to disk</li>
</ul>
<p>Assuming you have loaded a model and run <tt class="docutils literal"><span class="pre">mod.doState()</span></tt> the following
code opens a Python file object (<tt class="docutils literal"><span class="pre">rFile</span></tt>), writes the steady-state
results to the file associated with the file object (<tt class="docutils literal"><span class="pre">results.txt</span></tt>) and
then closes it again:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">rFile</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="s">&#39;results.txt&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">showState</span><span class="p">()</span>      <span class="c"># print the results to screen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">showState</span><span class="p">(</span><span class="n">rFile</span><span class="p">)</span> <span class="c"># write the results to the file results.txt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="writing-formatted-arrays">
<h2>Writing formatted arrays<a class="headerlink" href="#writing-formatted-arrays" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">showX()</span></tt> methods described in the previous sections allow the user a
convenient way to write the predefined matrices either to screen or file.
However, for maximum flexibility, PySCeS includes a suite of array writers
that enable one to easily write, in a variety of formats any array to a
file. Unlike the <tt class="docutils literal"><span class="pre">showX()</span></tt> methods, the <tt class="docutils literal"><span class="pre">Write_array</span></tt> methods are
specifically designed to write to data to a file.</p>
<p>In most modelling situations it is rare that an array needs to be stored or
displayed that does not have specific labels for its rows or columns.
Therefore, all the <tt class="docutils literal"><span class="pre">Write_array</span></tt> methods take list arguments that can
contain either the row or column labels. Obviously, these lists should be
equal in length to the matrix dimension they describe and in the correct
order.</p>
<p>There are currently three custom array writing methods that work either
with a 1D (vector) or 2D arrays (matrices). To allow an easy comparison of
the output of these methods, all the following sections use the same
example array as input.</p>
<div class="section" id="write-array">
<h3><tt class="docutils literal"><span class="pre">Write_array()</span></tt><a class="headerlink" href="#write-array" title="Permalink to this headline">¶</a></h3>
<p>The basic array writer is the <tt class="docutils literal"><span class="pre">Write_array()</span></tt> method. Using the default
settings this method writes a &#8216;tab delimited&#8217; array to a file. It is
trivial to change this to a &#8216;comma delimited&#8217; format by using the
<tt class="docutils literal"><span class="pre">separator</span> <span class="pre">=</span> <span class="pre">'</span> <span class="pre">'</span></tt> argument. Numbers in the array are formatted using the
global number format.</p>
<p>If column headings are supplied using the <tt class="docutils literal"><span class="pre">Col</span> <span class="pre">=</span> <span class="pre">[]</span></tt> argument they are
written above the relevant column and if necessary truncated to fit the
column width. If a column name is truncated it is marked with a <tt class="docutils literal"><span class="pre">*</span></tt> and
the full length name is written as a comment after the array data.
Similarly row data can be supplied using the <tt class="docutils literal"><span class="pre">Row</span> <span class="pre">=</span> <span class="pre">[]</span></tt> argument in which
case the row names are displayed as a comment which is written after the
array data.</p>
<p>Finally, if the <tt class="docutils literal"><span class="pre">close_file</span></tt> argument is enabled the supplied file object
is automatically closed after writing the array. The full call to the
method is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Write_array</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">File</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Row</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which generates the array</p>
<div class="highlight-python"><pre>## Write_array_linear1_11:12:23
#s0           s1           s2
-3.0043e-001  0.0000e+000  0.0000e+000
 1.5022e+000 -5.0217e-001  0.0000e+000
 0.0000e+000  1.5065e+000 -5.0650e-001
 0.0000e+000  0.0000e+000  1.0130e+000
# Row: R1 R2 R3 R4</pre>
</div>
<p>By default, each time an array is written, PySCeS includes an array header
consisting of the model name and the time the array was written. This
behaviour can be disabled by setting: <tt class="docutils literal"><span class="pre">mod.write_array_header</span> <span class="pre">=</span> <span class="pre">0</span></tt></p>
</div>
<div class="section" id="write-array-latex">
<h3><tt class="docutils literal"><span class="pre">Write_array_latex()</span></tt><a class="headerlink" href="#write-array-latex" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">Write_array_latex()</span></tt> method functions similarly to the generic
<tt class="docutils literal"><span class="pre">Write_array()</span></tt> method except that it generates a formatted array that
can be included directly in a LaTeXdocument. Additionally, there is no
separator argument, column headings are not truncated and row labels appear
to the left of the matrix.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span><span class="o">.</span><span class="n">Write_array_latex</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">File</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Row</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">Col</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>which generates</p>
<div class="highlight-python"><pre>%% Write_array_latex_linear1_11:45:03
\[
\begin{array}{r|rrr}
  &amp; $\small{s0}$ &amp; $\small{s1}$ &amp; $\small{s2}$ \\ \hline
 $\small{R1}$ &amp;-0.3004 &amp; 0.0000 &amp; 0.0000 \\
 $\small{R2}$ &amp; 1.5022 &amp;-0.5022 &amp; 0.0000 \\
 $\small{R3}$ &amp; 0.0000 &amp; 1.5065 &amp;-0.5065 \\
 $\small{R4}$ &amp; 0.0000 &amp; 0.0000 &amp; 1.0130 \\
\end{array}
\]</pre>
</div>
<p>and in a typeset document appears as:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="30%" />
<col width="30%" />
<col width="30%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>&nbsp;</td>
<td>s0</td>
<td>s1</td>
<td>s2</td>
</tr>
<tr class="row-even"><td>R1</td>
<td>-0.3004</td>
<td>0.0000</td>
<td>0.0000</td>
</tr>
<tr class="row-odd"><td>R2</td>
<td>1.5022</td>
<td>-0.5022</td>
<td>0.0000</td>
</tr>
<tr class="row-even"><td>R3</td>
<td>0.0000</td>
<td>1.5065</td>
<td>-0.5065</td>
</tr>
<tr class="row-odd"><td>R4</td>
<td>0.0000</td>
<td>0.0000</td>
<td>1.0130</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="installing-and-configuring">
<span id="installing-pysces"></span><h1>Installing and configuring<a class="headerlink" href="#installing-and-configuring" title="Permalink to this headline">¶</a></h1>
<p>Before installing or building PySCeS the following software is
required:</p>
<blockquote>
<div><ul class="simple">
<li>Python 2.5 (or 2.4 plus the Elementree/cElementree packages)</li>
<li>Numpy 1.2+</li>
<li>SciPy 0.7.0 (0.6.x will work with NumPy &gt; 1.0.5)</li>
<li>GCC 4.2+ on Linux or MinGW GCC 3.4.5 on Windows is required for building PySCeS from source only</li>
<li>Matplotlib 0.98.3 with the TkAgg backend (this is the default, but optional, plotting package but can be replaced with GnuPlot)</li>
</ul>
</div></blockquote>
<p>optional, but highly recommended, packages:</p>
<blockquote>
<div><ul class="simple">
<li>libSBML 3.x install with the Python bindings for SBML support</li>
<li>GnuPlot alternative plotting back-end</li>
<li>iPython highly recommended for interactive modelling sessions</li>
<li>SciTE editor for editing and running PySCeS based modelling programs</li>
</ul>
</div></blockquote>
<p>This software stack provides a powerful scientific programming
platform which is used by PySCeS to provide a flexible Systems
Biology Modelling environment.</p>
<p>PySCeS 0.7.0 itself has been modularised into a main package
and a (growing) number of support modules which extends its
core functionality. The most important of these is the advanced
simulation support added by installing PySundials
(<a class="reference external" href="http://pysundials.sf.net">http://pysundials.sf.net</a>). Linux users should build and
install the SUNDIALS library and PySundials (build instructions
on the PySundials web site). Windows users can simply download
and install the <em>pysces_pysundials</em> module.</p>
<blockquote>
<div><ul class="simple">
<li><em>pysces_pysundials</em> a binary port of SUNDIALS+PySundials for Windows</li>
<li><em>pysces_metatool</em> adds elementary mode support to PySCeS using MetaTool</li>
<li><em>pysces_mariner</em> SOAP based web services gateway, including a PySCeS server and remote client</li>
<li><em>pysces_kraken</em> (coming soon) PySCeS distributed processing module (currently distributed with PySCeS)</li>
</ul>
</div></blockquote>
<p>PySCeS and its extension modules use either the Python
distutils or the Numpy distutils extensions. Assuming you have
working versions of NumPy and SciPy on a Linux type operating
systems building PySCeS is as easy as:</p>
<div class="highlight-python"><pre>python setup.py install</pre>
</div>
<p>On Windows (with MinGW) depending on your system configuration
this becomes:</p>
<div class="highlight-python"><pre>python setup.py config --compiler=mingw32 build --compiler=mingw32 install</pre>
</div>
<p>In this release we have started prototyping Python egg support
(currently only for windows) which is implemented via the
<em>setupegg.py</em> build scripts.</p>
<p>By default PySCeS installs with a version of ZIB&#8217;s NLEQ2
non-linear solver. This software is distributed under its own
non-commercial licence. Please see the README.txt document provided
with this PySCeS installation for details.</p>
<div class="section" id="configuring">
<h2>Configuring<a class="headerlink" href="#configuring" title="Permalink to this headline">¶</a></h2>
<p>PySCeS has two configuration (*.ini) files that allows one to
specify global (per installation) and local (per user options).
Currently the multiuser options are only fully realised on
Linux based systems. Global options are stored in the
<em>pyscfg.ini</em> file which is created in your PySCeS
installation directory (this is a Windows version with the
Linux defaults indicated with in *value*):</p>
<div class="highlight-python"><pre>[Pysces]
install_dir = c:\python25\lib\site-packages\pysces
gnuplot_dir = c:\model\gnuplot\binaries
model_dir = os.path.join(os.getenv('HOMEDRIVE')+os.path.sep,'Pysces','psc')
output_dir = os.path.join(os.getenv('HOMEDRIVE')+os.path.sep,'Pysces')
*model_dir = os.path.join(os.path.expanduser('~'),'Pysces','psc')*
*output_dir = os.path.join(os.path.expanduser('~'),'Pysces')*</pre>
</div>
<p>The <em>[Pysces]</em> section contains information on the installation
directory, the directory where the GnuPlot executable(s) can be
found and the default model file and output directories. As we
shall see some of these defaults can be overruled by the local
configuration options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">ExternalModules</span><span class="p">]</span>
<span class="n">nleq2</span> <span class="o">=</span> <span class="bp">True</span>

<span class="p">[</span><span class="n">PyscesModules</span><span class="p">]</span>
<span class="n">pitcon</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>These sections define whether 3rd party algorithms (e.g. NLEQ2)
are available for use, while the last section allows the alternate
plotting backends to be enabled or disabled:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">PyscesConfig</span><span class="p">]</span>
<span class="n">gnuplot</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">matplotlib</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>The user configuration files (pys_usercfg.ini) are created when
PySCeS is imported/run for the <em>first time</em>. On Windows this is
in <tt class="docutils literal"><span class="pre">&lt;HOMEDRIVE&gt;\Pysces</span></tt> while on Linux this is in
<tt class="docutils literal"><span class="pre">$HOME\Pysces</span></tt>. Once created the user configuration files can
be edited and will be used for every subsequent PySCeS session:</p>
<div class="highlight-python"><pre>[Pysces]
output_dir = C:\mypysces
model_dir = C:\mypysces\pscmodels
gnuplot = False</pre>
</div>
<p>Here I have customised my default model and output directories
and disabled GnuPlot (enabled above). If required <em>gnuplot_dir</em>
can also be set to point to an alternate location on a per user
basis. Once you have PySCeS configured to your personal
requirements you are ready to begin modelling.</p>
</div>
</div>
<div class="section" id="references">
<span id="id8"></span><h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>Hofmeyr, J.-H.S. (2001) <em>Metabolic control analysis in a nutshell</em>,
in T.-M. Yi, M. Hucka, M. Morohashi, and H. Kitano, eds, Proceedings
of the 2nd International Conference on Systems Biology, pp. 291-300.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td>Kacser, H. and Burns, J. A. (1973), <em>The control of flux</em>,
Symp. Soc. Exp. Biol. <strong>32</strong>, 65-104.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[3]</a></td><td>Heinrich and Rappoport (1974), <em>A linear steady-state treatment of
enzymatic chains: General properties, control and effector strength</em>,
Eur. J. Biochem. <strong>42</strong>, 89-95.</td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="inputfile_doc.html" title="The PySCeS Model Description Language"
             >next</a> |</li>
        <li class="right" >
          <a href="userguide.html" title="PySCeS User Guide"
             >previous</a> |</li>
        <li><a href="userguide.html">PySCeS User Guide v0.9</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, Brett Oliver, Johann Rohwer, Jannie Hofmeyr.
      Last updated on Jun 03, 2014.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>